function analisar() {
  if (resultados.length < 1) {
    alert('Salve pelo menos 1 resultado para come√ßar a an√°lise.');
    return;
  }

  const brancos = resultados
    .map(r => horaParaMinutos(r.meio.horario))
    .filter(v => v !== null)
    .sort((a, b) => a - b);

  if (brancos.length === 0) {
    alert('Nenhum hor√°rio v√°lido do branco encontrado para an√°lise.');
    return;
  }

  const ultimoBranco = brancos[brancos.length - 1];
  let mediaIntervalo = 6;

  if (brancos.length >= 2) {
    const intervalos = [];
    for (let i = 1; i < brancos.length; i++) {
      intervalos.push(brancos[i] - brancos[i - 1]);
    }
    mediaIntervalo = intervalos.reduce((a, b) => a + b, 0) / intervalos.length;
  }

  const previsto = Math.round(ultimoBranco + mediaIntervalo);
  const previstoHora = minutosParaHora(previsto);
  ultimoPrevisto = previsto;

  document.getElementById('resultado').textContent = `üïì PR√ìXIMO BRANCO PROV√ÅVEL EM ${previstoHora} ‚Äî PREPARA!`;

  const conf = calcularConfian√ßa(mediaIntervalo, [], brancos);
  document.getElementById('confian√ßa').textContent = conf.text;
  document.getElementById('confian√ßa').style.color = conf.color;

  // Detec√ß√£o de chuva de brancos:
  // Conta quantos brancos sa√≠ram nos √∫ltimos 5 minutos antes do √∫ltimo branco
  let chuvaCount = 0;
  for (let i = brancos.length - 1; i >= 0; i--) {
    if (ultimoBranco - brancos[i] <= 5) {
      chuvaCount++;
    } else {
      break;
    }
  }

  if (chuvaCount >= 2) {
    document.getElementById('avisos').innerHTML = `<span style="color: #3498db; font-weight:bold;">‚òîÔ∏è CHUVA DE BRANCOS DETECTADA: ${chuvaCount} brancos nos √∫ltimos 5 minutos!</span>`;
  } else {
    document.getElementById('avisos').innerHTML = '';
  }

  // Bot√µes feedback como antes:
  document.getElementById('avisos').innerHTML += `
    <div style="margin-top:10px;">
      <button id="btnAcertou" style="margin-right:10px;">‚úÖ Acertou</button>
      <button id="btnErrou">‚ùå Errou</button>
    </div>
  `;

  document.getElementById('btnAcertou').onclick = () => {
    feedbacks[resultados.length - 1] = 'acerto';
    localStorage.setItem('feedbacks', JSON.stringify(feedbacks));
    alert('Feedback de ACERTO registrado!');
    atualizarLog();
    document.getElementById('avisos').innerHTML = '';
  };

  document.getElementById('btnErrou').onclick = () => {
    feedbacks[resultados.length - 1] = 'erro';
    localStorage.setItem('feedbacks', JSON.stringify(feedbacks));
    alert('Feedback de ERRO registrado!');
    atualizarLog();
    document.getElementById('avisos').innerHTML = '';
  };
}
