<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scofield Analista</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #eee;
    padding: 10px;
  }
  textarea {
    width: 100%;
    height: 200px;
    background: #222;
    color: #eee;
    border: none;
    padding: 10px;
    resize: vertical;
    font-family: monospace;
  }
  button {
    margin-top: 10px;
    padding: 10px 20px;
    font-weight: bold;
    background: #090;
    color: white;
    border: none;
    cursor: pointer;
  }
  #msg {
    margin-top: 10px;
    color: #0f0;
    font-weight: bold;
  }
  .resultado {
    margin-top: 20px;
  }
  .pedra {
    display: inline-block;
    width: 30px;
    height: 30px;
    margin-right: 5px;
    border-radius: 50%;
  }
  .vermelho {
    background: #f33;
    border: 2px solid #a00;
  }
  .preto {
    background: #222;
    border: 2px solid #555;
  }
  .branco {
    background: #eee;
    border: 2px solid #ccc;
  }
</style>
</head>
<body>

<h1>Scofield Analista</h1>

<textarea id="historico" placeholder="Cole o histórico aqui, ex:&#10;15/07/2025 19:14:55&#10;8&#10;19:14:55&#10;..."></textarea>
<button id="btnAnalisar">Analisar Histórico</button>
<div id="msg"></div>

<div id="resultados" class="resultado"></div>

<script>
const vermelhos = new Set(['1','2','3','4','5','6','7']);
const pretos = new Set(['8','9','11','12','13','14']);

function parseHistorico(text) {
  // O histórico esperado tem linhas triplas: data, número da pedra, horário
  // Exemplo: 15/07/2025 19:14:55 \n 8 \n 19:14:55
  const linhas = text.trim().split('\n').map(l => l.trim()).filter(l => l.length > 0);
  if (linhas.length < 3) {
    throw new Error('Histórico inválido ou incompleto (mínimo 3 linhas).');
  }
  if (linhas.length % 3 !== 0) {
    throw new Error('Formato inválido: número de linhas deve ser múltiplo de 3.');
  }
  const dados = [];
  for(let i=0; i<linhas.length; i+=3) {
    const data = linhas[i];
    const numeroPedra = linhas[i+1];
    const horario = linhas[i+2];

    // Detectar cor pela pedra
    let cor = '';
    if (vermelhos.has(numeroPedra)) {
      cor = 'vermelho';
    } else if (pretos.has(numeroPedra)) {
      cor = 'preto';
    } else {
      // Se o número não está em nenhuma lista, pode ser branco ou inválido
      // Como não há número para branco, vamos considerar branco se numeroPedra vazio ou não numérico
      if (!numeroPedra || isNaN(numeroPedra)) {
        cor = 'branco';
      } else {
        // Pode ser branco ou erro, mas para evitar erro vamos assumir branco
        cor = 'branco';
      }
    }

    dados.push({
      data,
      numeroPedra,
      horario,
      cor
    });
  }
  return dados;
}

function mostrarResultados(dados) {
  const div = document.getElementById('resultados');
  div.innerHTML = '';

  dados.forEach((item, idx) => {
    const p = document.createElement('p');
    p.textContent = `${item.data} ${item.horario} - Pedra: ${item.numeroPedra} Cor: ${item.cor.toUpperCase()}`;
    const spanCor = document.createElement('span');
    spanCor.className = `pedra ${item.cor}`;
    p.prepend(spanCor);
    div.appendChild(p);
  });
}

document.getElementById('btnAnalisar').addEventListener('click', () => {
  const texto = document.getElementById('historico').value;
  const msg = document.getElementById('msg');
  try {
    const dados = parseHistorico(texto);
    mostrarResultados(dados);
    msg.textContent = 'Histórico analisado com sucesso!';
    msg.style.color = '#0f0';
  } catch(e) {
    msg.textContent = 'Erro: ' + e.message;
    msg.style.color = '#f33';
  }
});
</script>

</body>
</html>
