<script>
  let resultados = [];

  function formatarHorario(date) {
    return date.toLocaleTimeString('pt-BR', {hour12: false});
  }

  function atualizarLista() {
    const listaEl = document.getElementById('listaResultados');
    listaEl.innerHTML = '';
    if (resultados.length === 0) {
      listaEl.innerHTML = '<li>Nenhum resultado registrado.</li>';
      return;
    }
    resultados.forEach(({cor, horario}) => {
      const li = document.createElement('li');
      li.textContent = `${formatarHorario(horario)} - ${cor.charAt(0).toUpperCase() + cor.slice(1)}`;
      listaEl.appendChild(li);
    });
  }

  function calcularProbabilidadeBranco() {
    if (resultados.length === 0) return 0;
    let brancoCount = resultados.filter(r => r.cor === 'branco').length;
    return (brancoCount / resultados.length) * 100;
  }

  function atualizarProbabilidade() {
    const probBranco = calcularProbabilidadeBranco();
    const probEl = document.getElementById('probabilidadeBranco');
    probEl.textContent = `Probabilidade de Branco: ${probBranco.toFixed(1)}%`;

    const limite = Number(document.getElementById('limiteBranco').value) || 25;
    const alertaEl = document.getElementById('alerta');

    if (probBranco >= limite && resultados.length > 0) {
      alertaEl.classList.add('show', 'ativo');
    } else {
      alertaEl.classList.remove('show', 'ativo');
    }
  }

  // üëâ FUN√á√ÉO QUE ESTAVA FALTANDO!
  function adicionarResultado(cor) {
    const horario = new Date();
    resultados.unshift({cor, horario});
    if (resultados.length > 50) resultados.pop(); // mant√©m no m√°ximo 50
    atualizarLista();
    atualizarProbabilidade();
  }
</script>
