<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Scofield Analista PRO+</title>
  <style>
    body { background:#111; color:#eee; font-family:'Segoe UI',sans-serif; padding:15px; }
    h1,h3 { margin:10px 0; color:#ff4747; text-align:center; }
    textarea,button { width:100%; margin:5px 0; padding:10px; border-radius:5px; box-sizing:border-box; }
    textarea { background:#222; color:#eee; border:1px solid #555; font-family:monospace; resize:vertical; }
    button { background:#ff4747; color:#fff; border:none; cursor:pointer; font-weight:700; }
    button:hover { background:#e53e3e; }
    .secao { background:#222; padding:15px; border-radius:8px; margin-bottom:20px; box-shadow:0 0 10px #ff4747aa; }
    .sinal { background:#333; padding:10px; margin:10px 0; border-radius:5px; }
    .estatisticas { background:#222; padding:10px; border-radius:5px; white-space:pre-wrap; max-height:150px; overflow-y:auto;}
    .alerta { background:#333; padding:10px; border-radius:5px; font-weight:700; margin-top:10px; }
  </style>
</head>
<body>
  <h1>Scofield Analista PRO+ ‚ö™üî•</h1>
  
  <div class="secao">
    <h3>üß† Hist√≥rico C√©rebro</h3>
    <textarea id="historicoCerebro" rows="8" placeholder="Cole aqui hist√≥rico completo: n√∫mero then hor√°rio..."></textarea>
    <button id="btnEnviar">üì§ Enviar Hist√≥rico</button>
    <div id="msgCerebro" style="color:#8f8;"></div>
    <div>üìå Estrat√©gias criadas: <span id="contadorEstrategias">0</span></div>
  </div>
  
  <div class="secao">
    <h3>‚è±Ô∏è An√°lise em Tempo Real</h3>
    <textarea id="historicoAtual" rows="6" placeholder="Cole √∫ltimas jogadas para prever..."></textarea>
    <button id="btnAnalisar">üîç Analisar</button>
    <div id="alertaPadrao" class="alerta"></div>
    <div id="alertaRec" class="alerta" style="color:#ffb347;"></div>
    <div id="alertaChuva" class="alerta" style="color:#7df;"></div>
    <div id="previsoes"></div>
  </div>
  
  <div class="secao">
    <h3>üìä Estat√≠sticas</h3>
    <div id="estatisticas" class="estatisticas">Nenhuma estat√≠stica registrada ainda.</div>
    <button id="btnLimparEstat">üßπ Limpar Estat√≠sticas</button>
  </div>
  
  <div class="secao">
    <h3>üßº Limpar Campos de Hist√≥rico</h3>
    <button id="btnLimparHist">Limpar Campos</button>
    <div id="mensagemHistorico" style="color:#8f8;"></div>
  </div>

<script>
let estrategias = JSON.parse(localStorage.getItem("estrategias") || "[]");
let estatisticas = JSON.parse(localStorage.getItem("estatisticas") || "[]");

function salvarDados() {
  localStorage.setItem("estrategias", JSON.stringify(estrategias));
  localStorage.setItem("estatisticas", JSON.stringify(estatisticas));
  atualizarContadorEstrategias();
  atualizarEstatisticas();
}

// parse hist√≥rico simples (n√∫mero + hor√°rio por linha)
function parseHistorico(texto) {
  const linhas = texto.trim().split('\n').map(l=>l.trim()).filter(l=>l);
  const res = [];
  for(let i=0;i<linhas.length-1;i+=2){
    const num=linhas[i], hor=linhas[i+1];
    if(/^\d{2}:\d{2}:\d{2}$/.test(hor)) res.push({numero:num, horario:hor});
  }
  return res;
}

function enviaCerebro() {
  const txt=document.getElementById("historicoCerebro").value;
  const regs=parseHistorico(txt);
  if(regs.length<2){ document.getElementById("msgCerebro").innerText="‚ö†Ô∏è Hist√≥rico inv√°lido."; return; }
  estrategias.push({ padrao:regs.map(r=>r.numero), brancos:regs.map(r=>r.horario), criado:Date.now(), peso:1 });
  document.getElementById("msgCerebro").innerText="‚úÖ Hist√≥rico analisado com sucesso!";
  salvarDados();
}

function analisaAgora() {
  const txt=document.getElementById("historicoAtual").value;
  const regs=parseHistorico(txt);
  const outPre=document.getElementById("previsoes");
  const aPad=document.getElementById("alertaPadrao");
  const aRec=document.getElementById("alertaRec");
  const aCh=document.getElementById("alertaChuva");
  outPre.innerHTML=""; aPad.innerText=""; aRec.innerText=""; aCh.innerText="";
  if(regs.length<2){ aPad.innerText="‚ö†Ô∏è Hist√≥rico atual inv√°lido."; return; }
  
  const atualSeq=regs.map(r=>r.numero);
  const pad=estrategias.find(e=>JSON.stringify(e.padrao)===JSON.stringify(atualSeq));
  if(pad){
    aPad.innerText="‚úÖ Padr√£o reconhecido!";
    const proj=projetar(pad.brancos, regs);
    proj.forEach(h=>{
      const div= document.createElement("div"); div.className="sinal";
      div.innerHTML=`<strong>${h}</strong><button onclick="registra('${h}',1)">‚úÖ Acertou</button><button onclick="registra('${h}',0)">‚ùå Errou</button>`;
      outPre.appendChild(div);
    });
    if(pad.brancos.length<=1) aRec.innerText="‚ö†Ô∏è REC detectado.";
    if(pad.brancos.length>=4) aCh.innerText="üåßÔ∏è Chuva detectada.";
  } else {
    aPad.innerText="üîç Nenhum padr√£o. Usando previs√£o simples:";
    prevSimples(outPre);
  }
}

function projetar(hs, regs){
  const ultimo=toSec(regs[regs.length-1].horario);
  const padSecs=hs.map(toSec);
  const diff=ultimo-padSecs[padSecs.length-1];
  return padSecs.map(s=>{
    let v=s+diff;
    if(v<0)v+=86400; if(v>=86400)v-=86400;
    return fmt(v);
  }).filter(h=>toSec(h)>ultimo);
}

function prevSimples(div){
  const agora=new Date();
  let base=agora.getHours()*3600 + agora.getMinutes()*60 + agora.getSeconds();
  [60,120,180].forEach((t,i)=>{
    const h=fmt(base+t);
    const divp=document.createElement("div"); divp.className="sinal";
    divp.innerHTML=`<strong>${h}</strong> (${i==0?'Forte':i==1?'Moderado':'Arriscado'})<button onclick="registra('${h}',1)">‚úÖ Acertou</button><button onclick="registra('${h}',0)">‚ùå Errou</button>`;
    div.appendChild(divp);
  });
}

function registra(h, ok){
  estatisticas.push({horario:h, resultado: ok? "‚úÖ":"‚ùå", data:Date.now()});
  salvarDados();
  alert(`${ok? 'Acertou':'Errou'} em ${h}`);
}

function atualizarEstatisticas(){
  const div=document.getElementById("estatisticas");
  if(estatisticas.length===0) div.innerText="Nenhum resultado registrado.";
  else div.innerText = estatisticas.slice().reverse().map(e=>`${new Date(e.data).toLocaleString()} ‚Äì ${e.horario} ‚Äì ${e.resultado}`).join("\n");
}

function atualizarContadorEstrategias(){
  document.getElementById("contadorEstrategias").innerText=estrategias.length;
}

function limpaEstat(){
  if(confirm("Apagar estat√≠sticas?")){
    estatisticas=[];
    salvarDados();
  }
}

function limpaHist(){
  document.getElementById("historicoCerebro").value="";
  document.getElementById("historicoAtual").value="";
  document.getElementById("msgCerebro").innerText="";
  document.getElementById("alertaPadrao").innerText="";
  document.getElementById("alertaRec").innerText="";
  document.getElementById("alertaChuva").innerText="";
  document.getElementById("previsoes").innerHTML="";
  document.getElementById("mensagemHistorico").innerText="‚úÖ Campos limpos!";
}

function toSec(h){
  const [hh,mm,ss]=h.split(":").map(Number);
  return hh*3600+mm*60+ss;
}

function fmt(s){
  const hh=Math.floor(s/3600)%24;
  const mm=Math.floor((s%3600)/60);
  const ss=s%60;
  return `${hh.toString().padStart(2,"0")}:${mm.toString().padStart(2,"0")}:${ss.toString().padStart(2,"0")}`;
}

// Conectar eventos
document.getElementById("btnEnviar").onclick = enviaCerebro;
document.getElementById("btnAnalisar").onclick = analisaAgora;
document.getElementById("btnLimparEstat").onclick = limpaEstat;
document.getElementById("btnLimparHist").onclick = limpaHist;

// Inicializa√ß√£o
salvarDados();
</script>
</body>
</html>
