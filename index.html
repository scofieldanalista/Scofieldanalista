<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Scofield Analista PRO</title>
  <style>
    body {
      background: #111;
      color: #eee;
      font-family: 'Segoe UI', sans-serif;
      padding: 15px;
    }
    h1 { text-align: center; color: #ff4747; }
    textarea, input, button {
      width: 100%; padding: 10px; margin: 5px 0;
      border-radius: 5px; box-sizing: border-box;
    }
    textarea, input {
      background: #222; color: #eee; border: 1px solid #555;
    }
    button {
      background: #ff4747; color: white; border: none; cursor: pointer;
    }
    button:hover { background: #e53e3e; }
    .secao { margin-top: 25px; }
    .sinal {
      background: #222; padding: 10px; margin-top: 10px;
      border-radius: 5px;
    }
    .sinal button {
      width: 48%; margin: 2px 1%; font-weight: bold;
    }
    .estatisticas {
      white-space: pre-line;
      background: #222;
      padding: 10px;
      border-radius: 5px;
      margin-top: 15px;
      font-size: 1em;
    }
    #contadorEstrategias {
      margin-top: 10px;
      color: #0f0;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Scofield Analista PRO ‚ö™</h1>

  <div class="secao">
    <h3>üß† Hist√≥rico C√©rebro</h3>
    <textarea id="historicoCerebro" rows="8" placeholder="Cole aqui o hist√≥rico completo com hor√°rios, n√∫meros e cores..."></textarea>
    <button onclick="enviarCerebro()">üì§ Enviar Hist√≥rico</button>
    <div id="mensagemCerebro" style="margin-top:10px;color:#8f8;"></div>
  </div>

  <div class="secao">
    <h3>‚è±Ô∏è Come√ßar An√°lise</h3>
    <textarea id="historicoAtual" rows="6" placeholder="Cole aqui as √∫ltimas jogadas para prever os brancos..."></textarea>
    <button onclick="analisarAgora()">üîç Analisar</button>
    <div id="previsoes"></div>
  </div>

  <div class="secao">
    <h3>üìä Estat√≠sticas</h3>
    <div id="estatisticas" class="estatisticas"></div>
    <button onclick="limparEstatisticas()">üßπ Limpar Estat√≠sticas</button>
    <div id="contadorEstrategias"></div>
  </div>

  <div class="secao">
    <h3>üßº Limpar Hist√≥rico</h3>
    <button onclick="limparHistorico()">üßΩ Limpar Campos de Hist√≥rico</button>
    <div id="mensagemHistorico" style="margin-top:10px;color:#8f8;"></div>
  </div>
<script>
let estrategias = JSON.parse(localStorage.getItem("estrategias") || "[]");
let estatisticas = JSON.parse(localStorage.getItem("estatisticas") || "[]");

// ‚è≥ Atualiza contador vis√≠vel
function atualizarContadorEstrategias() {
  document.getElementById("contadorEstrategias").innerText =
    `üìö Estrat√©gias criadas: ${estrategias.length}`;
}

function salvarDados() {
  localStorage.setItem("estrategias", JSON.stringify(estrategias));
  localStorage.setItem("estatisticas", JSON.stringify(estatisticas));
  atualizarEstatisticas();
  atualizarContadorEstrategias();
}

function enviarCerebro() {
  const texto = document.getElementById("historicoCerebro").value.trim();
  if (texto.length < 10) return alert("Hist√≥rico muito curto.");

  const linhas = texto.split("\n").filter(l => l.trim() !== "");
  let novaCriada = false;

  for (let i = 2; i < linhas.length; i += 3) {
    const anterior = parseInt(linhas[i - 2]);
    const posterior = parseInt(linhas[i]);
    const horario = linhas[i - 1];
    const soma = anterior + posterior;
    const estrategiaExistente = estrategias.find(e => e.soma === soma);

    if (!estrategiaExistente && !isNaN(soma)) {
      estrategias.push({
        tipo: "soma",
        soma: soma,
        origem: "Hist√≥ricoC√©rebro",
        horarios: [horario],
        peso: 1
      });
      novaCriada = true;
    }
  }

  document.getElementById("mensagemCerebro").innerText = novaCriada
    ? "‚úÖ Hist√≥rico analisado com sucesso! Estrat√©gias atualizadas."
    : "‚úÖ Hist√≥rico analisado. Nenhuma nova estrat√©gia identificada.";

  salvarDados();
}

function analisarAgora() {
  const texto = document.getElementById("historicoAtual").value.trim();
  const linhas = texto.split("\n").filter(l => l.trim() !== "");
  if (linhas.length < 3) return alert("Hist√≥rico muito curto.");

  let horariosPrevistos = [];
  estrategias.forEach(estrategia => {
    if (estrategia.tipo === "soma") {
      for (let i = 2; i < linhas.length; i += 3) {
        const anterior = parseInt(linhas[i - 2]);
        const posterior = parseInt(linhas[i]);
        const horario = linhas[i - 1];
        const soma = anterior + posterior;
        if (soma === estrategia.soma) {
          horariosPrevistos.push({ horario, nivel: calcularNivel(estrategia.peso), estrategia });
        }
      }
    }
  });

  const div = document.getElementById("previsoes");
  div.innerHTML = horariosPrevistos.length
    ? `<h4>üü¢ Brancos Prov√°veis:</h4>`
    : `<h4>‚ùå Nenhuma previs√£o baseada em estrat√©gias aprendidas.</h4>`;

  horariosPrevistos.forEach(p => {
    const sinalDiv = document.createElement("div");
    sinalDiv.className = "sinal";
    sinalDiv.innerHTML = `
      <strong>${p.horario}</strong> (${p.nivel})<br>
      Estrat√©gia: Soma = ${p.estrategia.soma}<br>
      <button onclick="registrarResultado('${p.horario}', 'win', ${p.estrategia.soma})">‚úÖ Acertou</button>
      <button onclick="registrarResultado('${p.horario}', 'loss', ${p.estrategia.soma})">‚ùå Errou</button>
    `;
    div.appendChild(sinalDiv);
  });

  if (horariosPrevistos.length === 0) {
    const agora = new Date();
    for (let i = 1; i <= 3; i++) {
      const t = new Date(agora.getTime() + i * 60000);
      horariosPrevistos.push({
        horario: `${t.getHours().toString().padStart(2, '0')}:${t.getMinutes().toString().padStart(2, '0')}:${t.getSeconds().toString().padStart(2, '0')}`,
        nivel: i === 1 ? "Forte" : i === 2 ? "Moderado" : "Arriscado",
        estrategia: { soma: "Desconhecida" }
      });
    }
    div.innerHTML = `<h4>üîç Nenhuma estrat√©gia. Usando previs√£o simples:</h4>`;
    horariosPrevistos.forEach(p => {
      const sinalDiv = document.createElement("div");
      sinalDiv.className = "sinal";
      sinalDiv.innerHTML = `
        <strong>${p.horario}</strong> (${p.nivel})<br>
        <button onclick="registrarResultado('${p.horario}', 'win', -1)">‚úÖ Acertou</button>
        <button onclick="registrarResultado('${p.horario}', 'loss', -1)">‚ùå Errou</button>
      `;
      div.appendChild(sinalDiv);
    });
  }
}

function calcularNivel(peso) {
  return peso >= 3 ? "Forte" : peso === 2 ? "Moderado" : "Arriscado";
}

function registrarResultado(horario, resultado, soma) {
  estatisticas.push({ horario, resultado: resultado === 'win' ? '‚úÖ' : '‚ùå' });
  const estrategia = estrategias.find(e => e.soma === soma);
  if (estrategia) {
    if (resultado === 'win') estrategia.peso++;
    else estrategia.peso = Math.max(1, estrategia.peso - 1);
  }
  salvarDados();
}

function atualizarEstatisticas() {
  const div = document.getElementById("estatisticas");
  div.innerText = estatisticas.map(e => `${e.horario} ${e.resultado}`).reverse().join("\n");
}

function limparEstatisticas() {
  if (confirm("Tem certeza que deseja apagar as estat√≠sticas?")) {
    estatisticas = [];
    salvarDados();
  }
}

function limparHistorico() {
  document.getElementById("historicoCerebro").value = "";
  document.getElementById("historicoAtual").value = "";
  document.getElementById("mensagemCerebro").innerText = "";
  document.getElementById("previsoes").innerHTML = "";
  document.getElementById("mensagemHistorico").innerText = "‚úÖ Campos de hist√≥rico limpos! Estrat√©gias mantidas.";
}

atualizarEstatisticas();
atualizarContadorEstrategias();
</script>
</body>
</html>
